<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>LookingGlass by ytisf</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>LookingGlass</h1>
        <p>Your network research assistant</p>

        <p class="view"><a href="https://github.com/ytisf/LookingGlass">View the Project on GitHub <small>ytisf/LookingGlass</small></a></p>


        <ul>
          <li><a href="https://github.com/ytisf/LookingGlass/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/ytisf/LookingGlass/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/ytisf/LookingGlass">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="lookingglass" class="anchor" href="#lookingglass" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>LookingGlass</h1>

<h2>
<a id="abstract" class="anchor" href="#abstract" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Abstract</h2>

<p>LookingGlass is hosted at <a href="https://www.github.com">Github</a> and is located at <a href="https://lookingglass.morirt.com">https://LookingGlass.moriRT.com</a></p>

<p>LookingGlass is a Python tool intended on assisting networking researchers in identifying specific patterns, regex and specific data in various encodings in traffic and in PCAP files. The intention of LookingGlass is to assist the researcher in identifying the data you're interested at rather then doing various searches and dedicated scripts.</p>

<p>LookingGlass is a PCAP parsing tool to assist you with your traffic research. It is designed to look (at the moment) only on HTTP requests (parameterized only!) and highlight specific information types. Currently, LookingGlass is hunting these particular data types:</p>

<ul>
<li>IMEI</li>
<li>Credit Card numbers</li>
<li>Locations</li>
<li>IMSI</li>
<li>MSISDN</li>
<li>Longitudes &amp; Latitudes</li>
<li>Emails</li>
<li>MAC addresses (within requests not in tuple)</li>
<li>IP Addresses (within requests not in tuple)</li>
</ul>

<p>The data is searched within encodings such cas <code>base64</code>, <code>urlencoding</code>, <code>base58</code> and we try to eliminate false-positives with searching if data might be data like <code>unix epoch time</code>.</p>

<p>It will create two artifacts after execution:</p>

<ol>
<li>
<code>filename.csv</code> - A CSV with all requests and parameters found, parsed.</li>
<li>
<code>filename.html</code> - An HTML report only with the possible hits of patterns described above.</li>
</ol>

<p>A note for lazy - here is a 'help' with all arguments:</p>

<pre><code>These are the possible arguments:
    -f, --file           Single file mode. Path to PCAP file.
    -d, --directory      Directory to scan PCAPs in.
    -l, --live           Run in live sniffing on adapter. For example 'eth0' or 'en0'. (not recommended)
    -v, --verbose        Show more information while running.
    -u, --user           User configurations to search.
    -k, --kml            If coordinates are found, save a KML file as well.
    -h, --help           Shows this help menu.
    --falpos             Ignore data types that are not reliable such as MSISDN.

The options for user defined serrch are:
    'regex' - A regex to search. For example 'regex, (com\.([a-zA-z]+\.){1,3}[a-zA-z]+), Android Package Name'.
    'noraml' - Regular search for data. For example 'normal, SM-J700, Device Model'.
    'binary' - Hex encoded binary data. For example 'binary, 0363646e0377, BinarySearch'.
    'md5sum' - MD5 value of data. For example 'md5sum, 5554353444, MD5 of MSISDN'.
    'sha1sum' - SHA1 value of data. For example 'sha1sum, text_here, SHA1 of name'.
    'sha256' - SHA256 value of data. For example 'sha256, text_here, SHA256 of name'.
    'sha512' - SHA512 value of data. For example 'sha512, text_here, SHA512 of name'.
    'in_field_name' - Value to be in an HTTP parameter name. For example 'in_field_name, lat, Might be Latitude'.
    'field_name_is' - Exact value of HTTP parameter name. For example 'field_name_is, MSISDN, Phone number'.
</code></pre>

<p><em>Little Comment</em> - Because we get to record directly on devices sometimes, and on Android the recorder does not add the IP layer, we have added support for that as well.</p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<p>It's acutally kinda straightforward. Just go into this folder with a terminal (assuming Linux/OSX) and with pip run:</p>

<div class="highlight highlight-source-shell"><pre>pip install -r requirements.txt</pre></div>

<h2>
<a id="execution-types" class="anchor" href="#execution-types" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Execution Types</h2>

<h3>
<a id="single" class="anchor" href="#single" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Single</h3>

<p>Running the script on 1 PCAP file. Example of usage will be:</p>

<div class="highlight highlight-source-shell"><pre>looking_glass.py -f <span class="pl-s"><span class="pl-pds">'</span>FILENAME.pcap<span class="pl-pds">'</span></span></pre></div>

<h3>
<a id="folder-run" class="anchor" href="#folder-run" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Folder Run</h3>

<p>Running the script against several PCAPs within a single directory. Please notice that due to the laziness of the authors we are only searching for files with a .pcap extension.</p>

<p>Usage example:</p>

<div class="highlight highlight-source-shell"><pre>looking_glass.py -d <span class="pl-s"><span class="pl-pds">'</span>DIRECTORY<span class="pl-pds">'</span></span></pre></div>

<h3>
<a id="customized-search" class="anchor" href="#customized-search" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Customized Search</h3>

<p>Create a file of your choosing and add the terms you want to search. For string search just add:</p>

<pre><code>normal, SM-J700, Device Model
</code></pre>

<p>The <code>'normal'</code> means text search, the <code>'SM-J700'</code> is the string to search and the <code>'Device Model'</code> is the title for that search. Please notice that LookingGlass will attempt to search for the data in binary form as well as in different encodings such as Base64 and so on.</p>

<p>Another type of search is a regex search. For example:</p>

<pre><code>regex, (com\.([a-zA-z]+\.){1,3}[a-zA-z]+), Android Package Name
</code></pre>

<p>There is also binary data search:</p>

<pre><code>binary, 0363646e0377, Binary User Name
</code></pre>

<p>And Hash searches:</p>

<pre><code>md5sum, abc, MD5 of Name
sha1sum, text_here, SHA1 of name
sha256, text_here, SHA256 of name
sha512, text_here, SHA512 of name
</code></pre>

<p>Also, field names:</p>

<pre><code>in_field_name, lat, Might be Latitude
field_name_is, MSISDN, Phone number
</code></pre>

<p><code>in_field_name</code> will yield a result of the string is within an HTTP parameter whil <code>field_name_is</code> will yeild a response only if the field name is exactly a string match.</p>

<p>After you have saved the file you can call it like this:</p>

<div class="highlight highlight-source-shell"><pre>python looking_glass.py -f pcap_file.pcap -u user_search.txt</pre></div>

<h2>
<a id="license---gplv3" class="anchor" href="#license---gplv3" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>License - GPLv3</h2>

<p><a href="https://www.github.com/yitsf">Yuval tisf Nativ</a>, <a href="https://www.github.com/daganp">Dagan Pasternak</a></p>

<p>This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.</p>

<p>This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>

<p>You should have received a copy of the GNU General Public License
along with this program.  If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.</p>

<h2>
<a id="flow-chart" class="anchor" href="#flow-chart" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Flow Chart</h2>

<p>FlowChart created using the awesome <a href="https://github.com/knsv/mermaid">Mermaid</a> project.</p>

<p>Source can be found at <code>mermaid.md</code> and you can use <a href="http://knsv.github.io/mermaid/live_editor/#/view/Z3JhcGggVEQKICAgIHN0YXJ0W0xvb2tpbmdHbGFzcyBTdGFydF0KICAgIHN0YXRle0xpdmUvUENBUH0KICAgIHVzZXJfcGFyYW1bTG9hZCBVc2VyIFBhcmFtZXRlcnNdCiAgICBzdGFydC0tPiB1c2VyX3BhcmFtCiAgICB1c2VyX3BhcmFtIC0tPnN0YXRlCiAgICBhZGFwdFtTdGFydCBTbmlmZmluZ10KICAgIHN0YXRlLS0-IHxMaXZlfCBhZGFwdAogICAgY29sZFtSZWFkIFBDQVAgRmlsZV0KICAgIHN0YXRlLS0-IHxQQ0FQfCBjb2xkCiAgICB0aHJlYWRpbmdbQ3JlYXRlIFRocmVhZCBmb3IgRWFjaCBQYWNrZXRdCiAgICBjb2xkLS0-dGhyZWFkaW5nCiAgICBhZGFwdC0tPnRocmVhZGluZwogICAgaWRlbnR7SXMgSFRUUFJlcXVlc3Q_fQogICAgdGhyZWFkaW5nLS0-aWRlbnQKICAgIHBhcmFtc1tHZXRQYXJhbWV0ZXJzXQogICAgYmluW0RvUmF3U2VhcmNoXQogICAgaWRlbnQtLT58SFRUUFJlcXVlc3R8cGFyYW1zCiAgICBpZGVudC0tPnxCaW5hcnl8YmluCiAgICB2YXJzW0VuY29kaW5ncyBTZWFyY2hdCiAgICBkZWNvZGVbRGVjb2RlUGFyYW1zXQogICAgcGFyYW1zLS0-ZGVjb2RlCiAgICBiaW4tLT52YXJzCiAgICBkZWNvZGUtLT52YXJzCiAgICBqb2luW0pvaW5UaHJlYWRzXQogICAgdmFycy0tPmpvaW4KICAgIGNzdltXcml0ZUNTVl0KICAgIGh0bWxbV3JpdGVIVE1MXQogICAgam9pbi0tPmNzdgogICAgbWF0Y2h7TWF0Y2hlcyA_fQogICAgY3N2LS0-bWF0Y2gKICAgIG1hdGNoLS0-fFllc3xodG1sCiAgICBtYXRjaC0tPnxOb3xRdWl0CiAgICBodG1sLS0-UXVpdA">this</a> link to edit it.</p>

<p><img src="https://raw.githubusercontent.com/ytisf/LookingGlass/master/FlowChart.png" alt="LookingGlass FlowChart"></p>

<h2>
<a id="future-developments" class="anchor" href="#future-developments" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Future Developments</h2>

<h3>
<a id="version-10---venus" class="anchor" href="#version-10---venus" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Version 1.0 - Venus</h3>

<ul>
<li>[x] Base.</li>
</ul>

<h3>
<a id="version-11---bromhilda" class="anchor" href="#version-11---bromhilda" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Version 1.1 - Bromhilda</h3>

<ul>
<li>[x] <strong>BugFix</strong> - Fix CSS writer, which is an idiotic idea anyway.</li>
<li>[x] <strong>BugFix</strong> - If encountering Longitude for the 2nd time have it change to Latitude.</li>
<li>[x] <strong>BugFix</strong> - Make argument parsing done in a manner that is not embarassing to a 3 years old.</li>
<li>[x] <strong>Feature</strong> - Add email regex.</li>
<li>[x] <strong>Feature</strong> - Enable a flag to disable 'problematic' false-positive matches such as MSISDN.</li>
<li>[x] <strong>Improvments</strong> - Set <code>host</code> and <code>URI</code> in the report to a code tag.</li>
<li>[x] <strong>Improvments</strong> - Build a requirment file.</li>
<li>[x] <strong>Improvments</strong> - Change verbosity option when exeuting on multiple files.</li>
</ul>

<h3>
<a id="version-12---lia" class="anchor" href="#version-12---lia" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Version 1.2 - Lia</h3>

<ul>
<li>[x] <strong>Feature</strong> - Handeling JSON Requests</li>
<li>[x] <strong>Feature</strong> - Handeling XML Requests</li>
</ul>

<h3>
<a id="version-13---gaia" class="anchor" href="#version-13---gaia" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Version 1.3 - Gaia</h3>

<ul>
<li>[x] <strong>BugFix</strong> - Fixing various bugs.</li>
<li>[x] <strong>BugFix</strong> - Patching reports.</li>
</ul>

<h3>
<a id="version-14---benzaiten" class="anchor" href="#version-14---benzaiten" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Version 1.4 - Benzaiten</h3>

<ul>
<li>[x] <strong>Feature</strong> - Binary search.</li>
<li>[x] <strong>Feature</strong> - Add support for user based binary search.</li>
<li>[x] <strong>Feature</strong> - Ability to sniff live traffic.</li>
<li>[x] <strong>Improvments</strong> - Normal log file.</li>
<li>[x] <strong>Improvments</strong> - Preparation for different protocols.</li>
</ul>

<h3>
<a id="version-15---fariero" class="anchor" href="#version-15---fariero" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Version 1.5 - Fariero</h3>

<ul>
<li>[x] <strong>Feature</strong> - Export coordinations as KML.</li>
<li>[x] <strong>Improvments</strong> - Add IP address regex.</li>
<li>[x] <strong>Improvments</strong> - Several bug fixes and stability.</li>
</ul>

<h3>
<a id="version-151---fariero" class="anchor" href="#version-151---fariero" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Version 1.5.1 - Fariero</h3>

<ul>
<li>[x] <strong>BugFix</strong> - Bugfix in binary search.</li>
<li>[x] <strong>BugFix</strong> - Bugfix in hash search and display.</li>
</ul>

<h3>
<a id="version-16---gen" class="anchor" href="#version-16---gen" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Version 1.6 - GEN</h3>

<ul>
<li>[x] <strong>Feature</strong> - Search for field names (for example, passwords)</li>
<li>[x] <strong>Feature</strong> - Handeling Responses</li>
</ul>

<h3>
<a id="in-the-distant-future---the-year-2000" class="anchor" href="#in-the-distant-future---the-year-2000" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>In the Distant Future - The year 2000</h3>

<ul>
<li>[ ] Real cookies support</li>
<li>[ ] Reconstruction</li>
</ul>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/ytisf">ytisf</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
